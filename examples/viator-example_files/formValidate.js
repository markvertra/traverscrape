function f_validateForm(a){"undefined"==typeof a&&(a="form");for(var b=!0,c=0;c<document.forms[a].elements.length;c++){var d=document.forms[a].elements[c];f_useHiddenFieldIfCheckbox(d);var e=d.name+"_REQUIRED",f=document.forms[a].elements[e];if(f&&"T"==f.value&&""==d.value)return void alert("You must fill in the email address.");if("textarea"==d.type&&d.value.length>255)return void alert("Please limit your entries to only 255 characters");if(d.id.indexOf("email")>=0&&(b=f_isValidEmail(d.value),!b))return void d.focus()}$.get("/ajax-signUpNewsLetter.jspa?a="+Math.random()+"&email="+document.forms[a].EMAIL.value,function(a){a&&a.hasError?window.open("/silverpop/errorLHN.jsp?theerror="+escape(a.error),"NewsLetterSignUp","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=yes,resizable=no,width=600,height=180,left=120,top=120"):"signin"==a.type?window.location.href=a.https+"/content/account/SSL/signIn-form.jspa":"prefs"==a.type?window.location.href=a.http+"/profile/"+a.userId+"/preferences":($("#emailSignupFooter").hide(),window.s&&(window.s.linkTrackVars="prop6",window.s.prop6="LHN Module Prospect",window.s.tl(!0,"o","Email Signup: LHN Module Prospect")),Viator.Dialog.alert("Simply click on the link in the email we just sent you to verify your email address and you're done.",{text:{title:"You have successfully subscribed!"}}))})}function f_useHiddenFieldIfCheckbox(a_element){if("checkbox"==a_element.type&&"SYSTEM_"==a_element.name.substring(0,7)){var hiddenElement=eval("document.form.elements['"+a_element.name.substring(7)+"']");a_element.checked?hiddenElement.value="Yes":hiddenElement.value="No"}}function f_isValidEmail(a){if(null!=a&&""!=a){var b=/^(.+)@(.+)$/,c='\\(\\)<>@,;:\\\\\\"\\.\\[\\]',d="\\(\\)<>@,;:\\\\\\\"\\.\\[\\]\\'",e="[^\\s"+c+"]",f="[^\\s"+d+"]",g='("[^"]*")',h=/^\[(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})\]$/,i=e+"+",j=f+"+",k="("+i+"|"+g+")",l=new RegExp("^"+k+"(\\."+k+")*$"),m=new RegExp("^"+j+"(\\."+j+")*$"),n=a.match(b);if(null==n)return alert("The format of the email address you entered is not valid for email addresses."),!1;var o=n[1],p=n[2];if(null==o.match(l))return alert("Email username doesn't seem to be valid."),!1;var q=p.match(h);if(null!=q){for(var r=1;r<=4;r++)if(q[r]>255)return alert("Email IP address is invalid!"),!1;return!0}var s=p.match(m);if(null==s)return alert("Email domain name doesn't seem to be valid."),!1;var t=new RegExp(j,"g"),u=p.match(t),v=u.length;if(u[u.length-1].length<2||u[u.length-1].length>4)return alert("Email address must end in a three or four letter domain or a two letter country."),!1;if(v<2){var w="Email address is missing a hostname.";return alert(w),!1}}return!0}